{% extends "base.html" %}
{%- from 'components/back_link.html' import govukBackLink -%}
{%- from 'govuk_frontend_jinja/components/exit-this-page/macro.html' import govukExitThisPage -%}
{%- from 'govuk_frontend_jinja/components/summary-list/macro.html' import govukSummaryList -%}

{% block pageTitle %}Review your answers - GOV.UK{% endblock %}

{% block beforeContent%}
{{ super() }}
{{ govukBackLink() }}
{% endblock %}

{% block content %}
{{ super() }}
<div class="govuk-grid-row">
    <div class="govuk-grid-column-two-thirds">

        {% block formHeading %}
            <h1 class="govuk-heading-xl">Review your answers</h1>
            <form action="" method="post" novalidate>
                {{ form.csrf_token }}

                <h1>{% trans %}About the problem{% endtrans %}</h1>
                {# Parse the markdown before passing it to govukSummaryList #}
                {% set ns = namespace(rows=[]) %}
                {% for answer in scope_answers %}
                    {%  if answer.value.markdown %}
                        {% set _ = answer.__setitem__("value", {"text": answer.value.markdown | markdown(extensions=['nl2br'])}) %}
                    {% endif %}
                    {% set _ = ns.rows.append(answer) %}
                {% endfor %}
                {{ govukSummaryList(
                  {
                    "title": {
                        "classes": "govuk-heading-xl"
                    },
                    "rows": ns.rows,
                  }
                )}}

                {% for title, questions in means_test_summary.items() %}
                    <h2 class="govuk-heading-l">{{ title }}</h2>

                    {# Parse the markdown before passing it to govukSummaryList #}
                    {% set ns = namespace(rows=[]) %}
                    {% for question in questions %}
                        {%  if question.value.markdown %}
                            {% set _ = question.__setitem__("value", {"text": question.value.markdown | markdown(extensions=['nl2br'])}) %}
                        {% endif %}
                        {% set _ = ns.rows.append(question) %}
                    {% endfor %}

                    {{ govukSummaryList(
                      {
                        "title": {
                            "classes": "govuk-heading-xl"
                        },
                        "rows": ns.rows,
                        "attributes": {
                            "data-form": title,
                        }
                      }
                    )}}
                {% endfor %}
                {{ form.submit }}
            </form>
        {% endblock %}

    </div>
</div>
{% endblock %}