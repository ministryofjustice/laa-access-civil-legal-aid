name: Security

on: workflow_call

env:
    ACTIONS_STEP_DEBUG = true

jobs:
  zap_scan:
    runs-on: ubuntu-latest
    name: Scan the web application
    steps:
    - name: Checkout code
      uses: actions/checkout@v3

    - name: ZAP Full Scan
      uses: zaproxy/action-full-scan@v0.10.0
      with:
        target: 'https://security-pipeline-access-cla.cloud-platform.service.justice.gov.uk/'
        artifact_name: 'zap_report'
        rules_file_name: '.zap/rules.tsv'
        cmd_options: '-a'
      continue-on-error: true